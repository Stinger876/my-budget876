/* Updated logic inside updateUI() to calculate and show remainders */

planInc.forEach((p, i) => {
    budIncT += p.amt;
    // Calculate how much of this income category has been "filled"
    const received = txns.filter(t => t.amt > 0 && t.cat === p.name).reduce((s, t) => s + t.amt, 0);
    const remain = p.amt - received; // How much is left to earn
    
    catS.innerHTML += `<option value="${p.name}">ğŸ’° ${p.name}</option>`;
    incL.innerHTML += `<div class="budget-row">
        <span><button class="del-btn" style="font-size:12px;" onclick="planInc.splice(${i},1); hasUnsavedChanges=true; saveInternal();">ğŸ—‘ï¸</button> ${p.name}</span>
        <input type="number" class="plan-input" value="${p.amt}" onchange="planInc[${i}].amt=parseFloat(this.value)||0; hasUnsavedChanges=true; saveInternal();">
        <span class="pos" style="text-align:right">$${remain.toLocaleString()}</span>
    </div>`;
});

planExp.forEach((p, i) => {
    budExpT += p.amt;
    // Calculate how much of this expense category has been "spent"
    const spent = txns.filter(t => t.amt < 0 && t.cat === p.name).reduce((s, t) => s + Math.abs(t.amt), 0);
    const remain = p.amt - spent; // How much is left to spend
    
    catS.innerHTML += `<option value="${p.name}">${p.name}</option>`;
    expL.innerHTML += `<div class="budget-row">
        <span><button class="del-btn" style="font-size:12px;" onclick="planExp.splice(${i},1); hasUnsavedChanges=true; saveInternal();">ğŸ—‘ï¸</button> ${p.name}</span>
        <input type="number" class="plan-input" value="${p.amt}" onchange="planExp[${i}].amt=parseFloat(this.value)||0; hasUnsavedChanges=true; saveInternal();">
        <span class="${remain < 0 ? 'neg' : ''}" style="text-align:right">$${remain.toLocaleString()}</span>
    </div>`;
});

